(function(){var b=function(){this.Scanner=new FacebookPScanner;this.responseHeaderFixSingle=FPFixSingleResponse;this.reset()};b.prototype.data={user_id:null,fb_dtsg:null};b.prototype.reset=function(){for(var c in this.data)this.data[c]=null};b.prototype.fixSingle=function(c,e){function k(a){a=(new APIResponseHelper(d.responseHeaderFixSingle,ReturnCodeEnum.NETWORK_ERROR.code,ReturnCodeEnum.NETWORK_ERROR.description)).getResponse();PSDebug.error(a);return e(a)}function p(a){var b=g.handleResponse(f,
h,a);if(!b)return a=(new APIResponseHelper(d.responseHeaderFixSingle,ReturnCodeEnum.WEBRESPONSE_PARSE_ERROR.code,ReturnCodeEnum.WEBRESPONSE_PARSE_ERROR.description,"Web content parse error! ID: "+f+", value: "+h+", webData: "+a)).getResponse(),PSDebug.error(a),e(a);a=(new APIResponseHelper(d.responseHeaderFixSingle,ReturnCodeEnum.OK.code,ReturnCodeEnum.OK.description,b)).getResponse();PSDebug.log(a);return e(a)}function b(a){if(!l.isValidID(f))return a=(new APIResponseHelper(d.responseHeaderFixSingle,
ReturnCodeEnum.INVALID_ID.code,ReturnCodeEnum.INVALID_ID.description,"wrong ID! : "+f+", availableIDS: "+l.getAllvalidID())).getResponse(),PSDebug.error(a),e(a);if(!g.isValidFixValue(f,h))return a=(new APIResponseHelper(d.responseHeaderFixSingle,ReturnCodeEnum.INVALID_FIX_VALUE.code,ReturnCodeEnum.INVALID_FIX_VALUE.description,"wrong fix value! : "+h+", availableValues: "+g.getValidFixValueByID(f))).getResponse(),PSDebug.error(a),e(a);(function(){function a(){q--;if(0<q){var m=TMExt_$("#logoutMenu a")[0]||
TMExt_$("#pageLoginAnchor")[0];if(document.createEvent){var d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0);m.dispatchEvent(d)}else m.fireEvent("onclick");c=TMExt_$("input[name='fb_dtsg']").val();if(!c)return!1}else c="";if(n&&n.appIDs)for(var m=n.appIDs,d=n.bDelete,e=0;e<m.length;e++)SendWebRequest(g.getSendData(f,h,b,c,m[e],d),p,k);else SendWebRequest(g.getSendData(f,h,b,c),p,k);return!0}var b=d.data.user_id,c=d.data.fb_dtsg,q=5;if(PUtil.checkPage.IsFacebook()){if(b=CookieUtil.get("c_user"),
!a())var r=setInterval(function(){a()&&clearInterval(r)},3E3)}else SendWebRequest(l.getSendData_SettingPage(),function(a){(a=l.handleResponse_SettingPage(a))&&a.user_id&&a.fb_dtsg?(b=a.user_id,c=a.fb_dtsg,SendWebRequest(g.getSendData(f,h,b,c),p,k)):(a=(new APIResponseHelper(d.responseHeaderFixSingle,ReturnCodeEnum.NOT_LOGGED_IN.code,ReturnCodeEnum.NOT_LOGGED_IN.description)).getResponse(),PSDebug.error(a),e(a))})})()}var f=c.id,h=c.value,n=c.extra,d=this,l=null,g=null;d.Scanner.getUserInfo(function(){l=
new FacebookScannerHelper;g=new FacebookFixHelper;b(!1)},function(){l=new FacebookScannerHelper_Under18;g=new FacebookFixHelper_Under18;b(!0)},function(){},k)};window.FacebookPFixer=b;window.PSFix={fixSingle:function(c,e,k){(new b).fixSingle(c,e,function(b){b=b.FPFixSingleResponse.Response;b.code="success";return k(b)})}}})();
