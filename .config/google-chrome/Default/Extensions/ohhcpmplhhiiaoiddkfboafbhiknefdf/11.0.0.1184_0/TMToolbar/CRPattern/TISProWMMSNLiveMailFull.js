function filterbyHref(b){for(var a=["http://mail.live.com/","https://mail.live.com/","http://profile.live.com/","https://profile.live.com/"],c=0;c<a.length;c++)if(ptn=new RegExp(a[c],"i"),ptn.test(b))return!0;return!1}function TSWMMSNLiveSimpleShowRatingResultUI(){var b=this.level;return g_oRatingLevel[b]==g_oImgDefine.Safe||g_oRatingLevel[b]==g_oImgDefine.Neutral||g_oRatingLevel[b]==g_oImgDefine.Trusted?!1:!0}
function TSWMMSNLiveSimpleFetchTargetURL(b,a){var c=new RegExp("^(http|https|ftp|ftps)://"+b,"i");return/^(http|https|ftp|ftps):\/\//i.test(a)&&!c.test(a)?a:""}
function TSWMMSNLiveSimpleParseResult1(b){var a=new CreateTSRLocatedObject(null,null,"A",null);if(a=(new CreateTSRLocatedObject(b,a,"DIV","mainContentContainer")).findElement()){a=GetAllTSRLocatedNodes(a);b=b.location.host;for(var c=0;c<a.length;c++){var d=TSWMMSNLiveSimpleFetchTargetURL(b,a[c].href);0!=d.length&&(filterbyHref(d)||CreateTSRResultObject(a[c],d,null,TSWMMSNLiveSimpleShowRatingResultUI))}}}
function TSWMMSNLiveSimpleParseResult2(b){var a=new CreateTSRLocatedObject(null,null,"A",null),a=new CreateTSRLocatedObject(b,a,"DIV",null);a.appendAttribute("class","ContentRightInner");if(a=a.findElement()){a=GetAllTSRLocatedNodes(a);b=b.location.host;for(var c=0;c<a.length;c++){var d=TSWMMSNLiveSimpleFetchTargetURL(b,a[c].href);0!=d.length&&(filterbyHref(d)||CreateTSRResultObject(a[c],d,null,TSWMMSNLiveSimpleShowRatingResultUI))}}}g_bIsNeedCheckSPan=!0;TSRTagFlowID();
function TSRPrintRatingQueue(b){for(var a=0;a<b.length;++a){var c=b[a];c&&TrendMicro.TB.console.info("queue["+a+"]="+c.link)}}function TSRParse(){var b=g_oEnv.Parser.iResultNumber;TSWMMSNLiveSimpleParseResult1(document);TSWMMSNLiveSimpleParseResult2(document);TrendMicro.TB.ReduceNewNode(b+1);return g_oEnv.Parser.rgobjSearchResult};
