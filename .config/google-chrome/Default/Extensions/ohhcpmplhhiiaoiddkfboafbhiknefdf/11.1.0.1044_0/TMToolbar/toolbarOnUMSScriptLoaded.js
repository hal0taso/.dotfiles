(function(){tbc_sendRequest(TB_ACTIONS.CAN_MANUAL_RATING,{},function(g){var h={scripts:[getLocaleResource("_locales","TISProToolbarLocalization.js"),TB_PATHS.JS_CRENGINE_RES_DEFINE],csses:["TMToolbar/common_resource/TISProToolbar.css",getLocaleResource("_locales","css/TISProToolbar_l10n.css")]};tbc_sendRequest(TB_ACTIONS.INJECTRESOURCES,h,function(){function c(a){var b=document.getElementById(a);b||(b=document.createElement("div"),b.id=a,b.innerHTML="init_ums",b.style.display="None",document.documentElement.appendChild(b));
return b}var d={UMS_SEND_DATA_EVENT:"UMSSendDataEvent",listenToHTML:function(a){var b=a.target.getAttribute("data");a=a.target.getAttribute("docguid");d.handleData(a,b)},initToolTip:function(){try{TSRInitToolTip&&TSRInitToolTip(getURL(TB_PATHS.IMAGE_TOOLTIP),m_oSRSetting.bMouseOver.value,m_oSRSetting.bHighlight.value,m_oSRSetting.lTooltipTimeout.value,g.EnableImageSafeSearch,g.RatingTimeout)}catch(a){tbc_error("TSRInitToolTip not exists")}},handleData:function(a,b){var c=document.getElementById(TAG_ID4TOOLBAR_UMS_GUID).innerText;
TMExt_debug("start RATINGSINGLEURL url="+b);try{e.postMessage({action:TB_ACTIONS.RATINGSINGLEURL,params:{windowguid:c,url:b}})}catch(d){tbc_error(d)}}},e={};if(!document.getElementById("tmtoolbar_ums_injected")){if(!document.getElementById(TAG_ID4TOOLBAR_UMS_GUID)){var f=c(TAG_ID4TOOLBAR_UMS_GUID);f.innerText=GenerateGuid()}c("tmtoolbar_ums_injected");c(Communicator.UMS_EVENT_ID).addEventListener(Communicator.UMS_SEND_DATA_EVENT,function(a){d.listenToHTML(a)});f=c(TAG_ID4TOOLBAR_UMS_GUID);e=chrome.extension.connect({name:f.innerText});
e.onMessage.addListener(function(a){a=a.params;d.initToolTip();TMExt_debug("onMessage "+a.url+" ret=[ "+a.ratingLevel+" ]");g_manual_rating.callbackFromDoc(a.ratingLevel,a.url)});"undefined"===typeof window.Feedback2SiteSafety&&(window.Feedback2SiteSafety=function(a){tbc_sendRequest(TB_ACTIONS.FEEDBACK_2_SITESAFETY,{params:a},function(){})});d.initToolTip()}})})})();
