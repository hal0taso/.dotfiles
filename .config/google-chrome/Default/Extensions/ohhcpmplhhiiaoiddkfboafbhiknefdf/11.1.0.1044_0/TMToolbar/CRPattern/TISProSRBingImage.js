var SS_Util=TrendMicro.TB.SAFESEARCHING;
function foundImageCallback(b){TMExt_debug(b);var a=TMExt_$(b.FindInsertNode()).parent(),c=a.find("a").eq(0),d=c.find("img").eq(0);a.attr("link_level",b.level);SS_Util.isNeedToBlock(b.level)?(TMExt_debug("==========================BLOCK THE ABOVE ONE==================================="),SS_Util.checkImageBlockPopupExist(),a.css("display","inline-block"),a.css("height","100%"),a.css("text-decoration","none"),a.css("width","100%"),d.remove(),c.find("span").remove(),SS_Util.setBlockImage(a),SS_Util.bindMouseEnterEvent(a)):
TMExt_debug("the image level is "+b.level+", no need to block (level 8 is parent control category)")}function getRealUrl(b){try{var a=TMExt_$(b).attr("m"),c=a.indexOf('surl:"')+6,d=a.indexOf('"',c);return a.substring(c,d)}catch(e){return b.href}}
function TSSRParseResult_Image(b){var a=new CreateTSRLocatedObject(null,null,"a",null),a=new CreateTSRLocatedObject(null,a,"DIV",null);b=new CreateTSRLocatedObject(b,a,"DIV","dg_c");a.multiMatches=!0;a.appendAttribute("class","dg_u");if(b=b.findElement())for(b=GetAllTSRLocatedNodes(b),a=0;a<b.length;a++){var c=getRealUrl(b[a]);c&&CreateTSRResultObject(b[a],c,null,null,null,null,foundImageCallback)}}TSRTagFlowID();TMExt_debug("URL matched, start safe searching function");TMExt_$(window).resize(function(){SS_Util.refreshBlockImages()});
function TSRParse(){var b=g_oEnv.Parser.iResultNumber;TSSRParseResult_Image(document);TrendMicro.TB.ReduceNewNode(b+1);return g_oEnv.Parser.rgobjSearchResult};
